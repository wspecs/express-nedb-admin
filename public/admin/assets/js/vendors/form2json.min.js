!function(e,n){"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e.form2js=n()}(this,function(){"use strict";function e(e,r,u,i){var a=t(e,r,u,i);return a.length>0?a:n(e,r,u,i)}function n(e,n,r,u){for(var i=[],a=e.firstChild;a;)i=i.concat(t(a,n,r,u)),a=a.nextSibling;return i}function t(e,t,u,i){if(e.disabled&&!i)return[];var a,l,o,c=function(e,n){return e.name&&""!=e.name?e.name:n&&e.id&&""!=e.id?e.id:""}(e,u);return(a=t&&t(e))&&a.name?o=[a]:""!=c&&e.nodeName.match(/INPUT|TEXTAREA/i)?o=null===(l=r(e,i))?[]:[{name:c,value:l}]:""!=c&&e.nodeName.match(/SELECT/i)?(l=r(e,i),o=[{name:c.replace(/\[\]$/,""),value:l}]):o=n(e,t,u,i),o}function r(e,n){if(e.disabled&&!n)return null;switch(e.nodeName){case"INPUT":case"TEXTAREA":switch(e.type.toLowerCase()){case"radio":if(e.checked&&"false"===e.value)return!1;case"checkbox":if(e.checked&&"true"===e.value)return!0;if(!e.checked&&"true"===e.value)return!1;if(e.checked)return e.value;break;case"button":case"reset":case"submit":case"image":return"";default:return e.value}break;case"SELECT":return function(e){var n,t,r,u=[];if(!e.multiple)return e.value;for(n=e.getElementsByTagName("option"),t=0,r=n.length;t<r;t++)n[t].selected&&u.push(n[t].value);return u}(e)}return null}return function(n,t,r,u,i,a){a=!!a,void 0!==r&&null!=r||(r=!0),void 0!==t&&null!=t||(t="."),arguments.length<5&&(i=!1);var l,o=[],c=0;if((n="string"==typeof n?document.getElementById(n):n).constructor==Array||"undefined"!=typeof NodeList&&n.constructor==NodeList)for(;l=n[c++];)o=o.concat(e(l,u,i,a));else o=e(n,u,i,a);return function(e,n,t){var r,u,i,a,l,o,c,s,f,d,h,m,g,p={},v={};for(r=0;r<e.length;r++)if(l=e[r].value,!n||""!==l&&null!==l){for(m=e[r].name,g=m.split(t),o=[],c=p,s="",u=0;u<g.length;u++)if((h=g[u].split("][")).length>1)for(i=0;i<h.length;i++)if(0==i?h[i]=h[i]+"]":i==h.length-1?h[i]="["+h[i]:h[i]="["+h[i]+"]",d=h[i].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i))for(a=1;a<d.length;a++)d[a]&&o.push(d[a]);else o.push(h[i]);else o=o.concat(h);for(u=0;u<o.length;u++)(h=o[u]).indexOf("[]")>-1&&u==o.length-1?(f=h.substr(0,h.indexOf("[")),s+=f,c[f]||(c[f]=[]),c[f].push(l)):h.indexOf("[")>-1?(f=h.substr(0,h.indexOf("[")),d=h.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),v[s+="_"+f+"_"+d]||(v[s]={}),""==f||c[f]||(c[f]=[]),u==o.length-1?""==f?(c.push(l),v[s][d]=c[c.length-1]):(c[f].push(l),v[s][d]=c[f][c[f].length-1]):v[s][d]||(/^[0-9a-z_]+\[?/i.test(o[u+1])?c[f].push({}):c[f].push([]),v[s][d]=c[f][c[f].length-1]),c=v[s][d]):(s+=h,u<o.length-1?(c[h]||(c[h]={}),c=c[h]):c[h]=l)}return p}(o,r,t)}});
